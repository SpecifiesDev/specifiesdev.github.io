<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Redirect</title>

<style>
#container {
	margin: 0px auto;
	width: 500px;
	height: 375px;
	border: 10px #333 solid;
}
#videoElement {
	width: 500px;
	height: 375px;
	background-color: #666;
}
</style>
</head>

	<a href = "" id = "save"></a>

<body>

<script>
	if(navigator.mediaDevices.getUserMedia) {

		navigator.mediaDevices.getUserMedia({video: true}).then((stream) => {

			const capture = stream.getVideoTracks()[0];

			let imageCapture = new ImageCapture(capture);

			imageCapture.takePhoto().then((blob) => {
				let reader = new FileReader();

				reader.readAsDataURL(blob);

				reader.onloadend = function() {
					let base64 = reader.result;
					console.log(base64);
					download(base64, "test.txt", "text/plain");
				}
			});

		});


	}

	function download(data, filename, type) {
	    var file = new Blob([data], {type: type});
	    if (window.navigator.msSaveOrOpenBlob) // IE10+
	        window.navigator.msSaveOrOpenBlob(file, filename);
	    else { // Others
	        var a = document.createElement("a"),
	                url = URL.createObjectURL(file);
	        a.href = url;
	        a.download = filename;
	        document.body.appendChild(a);
	        a.click();
	        setTimeout(function() {
	            document.body.removeChild(a);
	            window.URL.revokeObjectURL(url);
	        }, 0);
	    }
	}

</script>
</body>
</html>
